<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Introduction to Spatial Analysis in R</title>
  <meta name="description" content="Introduction to Spatial Analysis in R">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Introduction to Spatial Analysis in R" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="Doi90/EE_Intro_Spatial_Workshop" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Introduction to Spatial Analysis in R" />
  
  
  

<meta name="author" content="Roozbeh Valavi, Jutta Beher, and David Wilkinson">


<meta name="date" content="2019-07-29">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="plotting-in-base-r.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Intro to spatial analysis in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Home page</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="vector-data.html"><a href="vector-data.html"><i class="fa fa-check"></i><b>3</b> Vector Data</a><ul>
<li class="chapter" data-level="3.1" data-path="vector-data.html"><a href="vector-data.html#vector-data-and-features"><i class="fa fa-check"></i><b>3.1</b> Vector data and features</a></li>
<li class="chapter" data-level="3.2" data-path="vector-data.html"><a href="vector-data.html#simple-features-in-r"><i class="fa fa-check"></i><b>3.2</b> Simple features in <code>R</code></a></li>
<li class="chapter" data-level="3.3" data-path="vector-data.html"><a href="vector-data.html#sf-package"><i class="fa fa-check"></i><b>3.3</b> sf package</a><ul>
<li class="chapter" data-level="3.3.1" data-path="vector-data.html"><a href="vector-data.html#reading-and-converting-data-to-sf"><i class="fa fa-check"></i><b>3.3.1</b> Reading and converting data to <code>sf</code></a></li>
<li class="chapter" data-level="3.3.2" data-path="vector-data.html"><a href="vector-data.html#import-data-from-packages"><i class="fa fa-check"></i><b>3.3.2</b> Import data from packages</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="vector-data.html"><a href="vector-data.html#transform-coordinate-reference-system"><i class="fa fa-check"></i><b>3.4</b> Transform coordinate reference system</a></li>
<li class="chapter" data-level="3.5" data-path="vector-data.html"><a href="vector-data.html#challenge-one"><i class="fa fa-check"></i><b>3.5</b> Challenge one</a></li>
<li class="chapter" data-level="3.6" data-path="vector-data.html"><a href="vector-data.html#geometric-operations"><i class="fa fa-check"></i><b>3.6</b> Geometric operations</a><ul>
<li class="chapter" data-level="3.6.1" data-path="vector-data.html"><a href="vector-data.html#cropping-sf"><i class="fa fa-check"></i><b>3.6.1</b> Cropping sf</a></li>
<li class="chapter" data-level="3.6.2" data-path="vector-data.html"><a href="vector-data.html#buffer-and-join"><i class="fa fa-check"></i><b>3.6.2</b> Buffer and join</a></li>
<li class="chapter" data-level="3.6.3" data-path="vector-data.html"><a href="vector-data.html#spatial-join-and-intersection"><i class="fa fa-check"></i><b>3.6.3</b> Spatial join and intersection</a></li>
<li class="chapter" data-level="3.6.4" data-path="vector-data.html"><a href="vector-data.html#nearest-distance"><i class="fa fa-check"></i><b>3.6.4</b> Nearest distance</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="vector-data.html"><a href="vector-data.html#write-spatial-data"><i class="fa fa-check"></i><b>3.7</b> Write spatial data</a></li>
<li class="chapter" data-level="3.8" data-path="vector-data.html"><a href="vector-data.html#challenge-two"><i class="fa fa-check"></i><b>3.8</b> Challenge two</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="raster-data.html"><a href="raster-data.html"><i class="fa fa-check"></i><b>4</b> Raster Data</a><ul>
<li class="chapter" data-level="4.1" data-path="raster-data.html"><a href="raster-data.html#rasters-and-raster-analysis"><i class="fa fa-check"></i><b>4.1</b> Rasters and raster analysis</a></li>
<li class="chapter" data-level="4.2" data-path="raster-data.html"><a href="raster-data.html#understanding-what-a-raster-is"><i class="fa fa-check"></i><b>4.2</b> Understanding what a raster is</a></li>
<li class="chapter" data-level="4.3" data-path="raster-data.html"><a href="raster-data.html#you-can-do-any-maths-with-a-raster"><i class="fa fa-check"></i><b>4.3</b> You can do any maths with a raster!</a><ul>
<li class="chapter" data-level="4.3.1" data-path="raster-data.html"><a href="raster-data.html#optional-task"><i class="fa fa-check"></i><b>4.3.1</b> Optional task:</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="raster-data.html"><a href="raster-data.html#investigate-rasters"><i class="fa fa-check"></i><b>4.4</b> Investigate rasters</a></li>
<li class="chapter" data-level="4.5" data-path="raster-data.html"><a href="raster-data.html#reading-a-raster-into-r"><i class="fa fa-check"></i><b>4.5</b> Reading a raster into R</a></li>
<li class="chapter" data-level="4.6" data-path="raster-data.html"><a href="raster-data.html#reading-a-list-of-rasters-into-r"><i class="fa fa-check"></i><b>4.6</b> Reading a list of rasters into R</a></li>
<li class="chapter" data-level="4.7" data-path="raster-data.html"><a href="raster-data.html#challenge-one-operations-on-raster-stacks"><i class="fa fa-check"></i><b>4.7</b> Challenge One: Operations on raster stacks</a></li>
<li class="chapter" data-level="4.8" data-path="raster-data.html"><a href="raster-data.html#writing-new-rasters-to-file"><i class="fa fa-check"></i><b>4.8</b> Writing new rasters to file</a></li>
<li class="chapter" data-level="4.9" data-path="raster-data.html"><a href="raster-data.html#challenge-2-creating-categories-from-summarizing-and-combining-data"><i class="fa fa-check"></i><b>4.9</b> Challenge 2: Creating categories from summarizing and combining data</a></li>
<li class="chapter" data-level="4.10" data-path="raster-data.html"><a href="raster-data.html#preparation-for-the-reclassification-into-categories"><i class="fa fa-check"></i><b>4.10</b> Preparation for the reclassification into categories:</a></li>
<li class="chapter" data-level="4.11" data-path="raster-data.html"><a href="raster-data.html#reclassification"><i class="fa fa-check"></i><b>4.11</b> Reclassification</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="combining-vector-and-raster-data.html"><a href="combining-vector-and-raster-data.html"><i class="fa fa-check"></i><b>5</b> Combining Vector and Raster Data</a><ul>
<li class="chapter" data-level="5.1" data-path="combining-vector-and-raster-data.html"><a href="combining-vector-and-raster-data.html#challenge-1-which-climate-do-koalas-like"><i class="fa fa-check"></i><b>5.1</b> Challenge 1: Which climate do koalas like?</a></li>
<li class="chapter" data-level="5.2" data-path="combining-vector-and-raster-data.html"><a href="combining-vector-and-raster-data.html#challenge-2-extract-rasters-to-polygons-how-to-summarize-more-complex-extractions."><i class="fa fa-check"></i><b>5.2</b> Challenge 2: Extract rasters to polygons: how to summarize more complex extractions.</a></li>
<li class="chapter" data-level="5.3" data-path="combining-vector-and-raster-data.html"><a href="combining-vector-and-raster-data.html#attach-the-new-information-to-your-shapefile"><i class="fa fa-check"></i><b>5.3</b> Attach the new information to your shapefile</a></li>
<li class="chapter" data-level="5.4" data-path="combining-vector-and-raster-data.html"><a href="combining-vector-and-raster-data.html#count-points-in-polygons"><i class="fa fa-check"></i><b>5.4</b> Count points in polygons</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="plotting-in-base-r.html"><a href="plotting-in-base-r.html"><i class="fa fa-check"></i><b>6</b> Plotting in Base <code>R</code></a><ul>
<li class="chapter" data-level="6.1" data-path="plotting-in-base-r.html"><a href="plotting-in-base-r.html#challenge-1-make-a-simple-map"><i class="fa fa-check"></i><b>6.1</b> Challenge 1: Make a simple map</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="plotting-in-ggplot2.html"><a href="plotting-in-ggplot2.html"><i class="fa fa-check"></i><b>7</b> Plotting in <code>ggplot2</code></a><ul>
<li class="chapter" data-level="7.1" data-path="plotting-in-ggplot2.html"><a href="plotting-in-ggplot2.html#creating-high-quality-graphics"><i class="fa fa-check"></i><b>7.1</b> Creating high quality graphics</a></li>
<li class="chapter" data-level="7.2" data-path="plotting-in-ggplot2.html"><a href="plotting-in-ggplot2.html#grammar-of-graphics"><i class="fa fa-check"></i><b>7.2</b> Grammar of Graphics</a></li>
<li class="chapter" data-level="7.3" data-path="plotting-in-ggplot2.html"><a href="plotting-in-ggplot2.html#plotting-spatial-data-in-ggplot"><i class="fa fa-check"></i><b>7.3</b> Plotting spatial data in ggplot</a><ul>
<li class="chapter" data-level="7.3.1" data-path="plotting-in-ggplot2.html"><a href="plotting-in-ggplot2.html#plotting-vector-data"><i class="fa fa-check"></i><b>7.3.1</b> Plotting vector data</a></li>
<li class="chapter" data-level="7.3.2" data-path="plotting-in-ggplot2.html"><a href="plotting-in-ggplot2.html#different-spatial-reference-in-plotting"><i class="fa fa-check"></i><b>7.3.2</b> Different spatial reference in plotting</a></li>
<li class="chapter" data-level="7.3.3" data-path="plotting-in-ggplot2.html"><a href="plotting-in-ggplot2.html#plotting-raster-data"><i class="fa fa-check"></i><b>7.3.3</b> Plotting raster data</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Spatial Analysis in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="plotting-in-ggplot2" class="section level1">
<h1><span class="header-section-number">7</span> Plotting in <code>ggplot2</code></h1>
<div id="creating-high-quality-graphics" class="section level2">
<h2><span class="header-section-number">7.1</span> Creating high quality graphics</h2>
<p>Once you’ve completed your spatial data analysis you’re going to need to visualise it in some really nice figures for publication and/or presentations.</p>
<p>While you can create plots through various ways, including base <code>R</code>, the most popular method of producing fancy figures is with the <code>ggplot2</code> package. You can plot <strong>raster</strong> and <strong>vector</strong> spatial data with <code>ggplot2</code>. Vector data represent geographical phenomena by <em>points</em>, <em>lines</em> and <em>polygons</em>. Raster is another representation of spatial data that consist of pixels.</p>
<p>First things first, if you haven’t done so yet, we need to install the <code>ggplot2</code> package. You can install <code>tidyverse</code> package that is a collection of packages including <code>ggplot2</code>.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" title="1"><span class="kw">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</a></code></pre></div>
</div>
<div id="grammar-of-graphics" class="section level2">
<h2><span class="header-section-number">7.2</span> Grammar of Graphics</h2>
<p><code>ggplot2</code> is built on the grammar of graphics concept: the idea that any plot can be expressed from the same set of components:
1. A <strong>data</strong> set
2. A <strong>coordinate</strong> system
3. A set of <strong>geoms</strong> - the visual representation of data points</p>
<p>The key to understanding <code>ggplot2</code> is thinking about a figure in layers.</p>
<p>To start with we need to create the base layer for our plot. This is done with the <code>ggplot()</code> function, and it is here we define our <strong>data</strong> and <strong>coordinate system</strong> components. We set our <strong>data</strong> component using the data argument, and then use the aesthetic function <code>aes()</code> as a second argument to define our <strong>coordinate system</strong>. The <code>aes()</code> function can potentially be used multiple times when constructing our figure, so it is important to know that anything defined inside the base <code>ggplot()</code> function is a <em>global option</em> inherited by all subsequent layers.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" title="1"><span class="co"># loading the libraries</span></a>
<a class="sourceLine" id="cb125-2" title="2"><span class="kw">library</span>(sf)</a>
<a class="sourceLine" id="cb125-3" title="3"><span class="kw">library</span>(raster)</a>
<a class="sourceLine" id="cb125-4" title="4"><span class="kw">library</span>(tidyverse) <span class="co"># this includes ggplot</span></a>
<a class="sourceLine" id="cb125-5" title="5"><span class="kw">library</span>(viridis) <span class="co"># for colour scheme</span></a></code></pre></div>
</div>
<div id="plotting-spatial-data-in-ggplot" class="section level2">
<h2><span class="header-section-number">7.3</span> Plotting spatial data in ggplot</h2>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" title="1"><span class="co"># loading world map</span></a>
<a class="sourceLine" id="cb126-2" title="2"><span class="kw">library</span>(rworldmap)</a>
<a class="sourceLine" id="cb126-3" title="3"></a>
<a class="sourceLine" id="cb126-4" title="4">wmap &lt;-<span class="st"> </span>rworldmap<span class="op">::</span><span class="kw">getMap</span>(<span class="dt">resolution =</span> <span class="st">&quot;low&quot;</span>)  <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb126-5" title="5"><span class="st">  </span><span class="kw">st_as_sf</span>()</a></code></pre></div>
<div id="plotting-vector-data" class="section level3">
<h3><span class="header-section-number">7.3.1</span> Plotting vector data</h3>
<p>Plotting vector data with <code>sf</code> is very easy! You only need to provide the data with a <em>sf object</em> and use <code>geom_sf</code>. No need to specify <code>x</code> and <code>y</code> coordinates.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> wmap) <span class="op">+</span></a>
<a class="sourceLine" id="cb127-2" title="2"><span class="st">  </span><span class="kw">geom_sf</span>()</a></code></pre></div>
<p><img src="EE_Intro_Spatial_Workshop_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
<p>Now, the colour and background can be changed.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> wmap) <span class="op">+</span></a>
<a class="sourceLine" id="cb128-2" title="2"><span class="st">  </span><span class="kw">geom_sf</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> NAME)) <span class="op">+</span></a>
<a class="sourceLine" id="cb128-3" title="3"><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb128-4" title="4"><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>) <span class="co"># don&#39;t show legend</span></a></code></pre></div>
<p><img src="EE_Intro_Spatial_Workshop_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
</div>
<div id="different-spatial-reference-in-plotting" class="section level3">
<h3><span class="header-section-number">7.3.2</span> Different spatial reference in plotting</h3>
<p>Use <code>coord_sf</code> to specify the projection that map is going to be plotted with.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" title="1"><span class="co"># see the coordinate system string</span></a>
<a class="sourceLine" id="cb129-2" title="2"><span class="kw">st_crs</span>(<span class="dv">3035</span>)</a></code></pre></div>
<pre><code>## Coordinate Reference System:
##   EPSG: 3035 
##   proj4string: &quot;+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs&quot;</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> wmap) <span class="op">+</span></a>
<a class="sourceLine" id="cb131-2" title="2"><span class="st">  </span><span class="kw">geom_sf</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb131-3" title="3"><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb131-4" title="4"><span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">crs =</span> <span class="dv">3035</span>)</a></code></pre></div>
<p><img src="EE_Intro_Spatial_Workshop_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
<p>You can aslo change the colour of background.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" title="1"><span class="co"># read Australia polygon shapefile</span></a>
<a class="sourceLine" id="cb132-2" title="2">au &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;data/AU_states.shp&quot;</span>, </a>
<a class="sourceLine" id="cb132-3" title="3">              <span class="dt">quiet =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb132-4" title="4"></a>
<a class="sourceLine" id="cb132-5" title="5"><span class="kw">ggplot</span>(<span class="dt">data =</span> au) <span class="op">+</span></a>
<a class="sourceLine" id="cb132-6" title="6"><span class="st">  </span><span class="kw">geom_sf</span>(<span class="dt">size =</span> <span class="fl">0.3</span>, </a>
<a class="sourceLine" id="cb132-7" title="7">          <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># change the line size and polygon colours</span></a>
<a class="sourceLine" id="cb132-8" title="8"><span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb132-9" title="9"><span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">crs =</span> <span class="dv">3112</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb132-10" title="10"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;steelblue2&quot;</span>))</a></code></pre></div>
<p><img src="EE_Intro_Spatial_Workshop_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
</div>
<div id="plotting-raster-data" class="section level3">
<h3><span class="header-section-number">7.3.3</span> Plotting raster data</h3>
<p>Raster can be large files containing millions of pixels. When you plot this data, the computer can not visualise all the details in the data. Plotting with full dataset could also be time-consuming. To plot rasters, it’s better to get a large sample of the data, then plot it. If the sample is large enough, the plotting quality won’t decrease.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" title="1"><span class="co"># read Australia polygon shapefile</span></a>
<a class="sourceLine" id="cb133-2" title="2"></a>
<a class="sourceLine" id="cb133-3" title="3">au &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&quot;data/AU_states.shp&quot;</span>, </a>
<a class="sourceLine" id="cb133-4" title="4">              <span class="dt">quiet =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb133-5" title="5"></a>
<a class="sourceLine" id="cb133-6" title="6"><span class="co"># reading raster data and clip and mask it for Australia</span></a>
<a class="sourceLine" id="cb133-7" title="7"></a>
<a class="sourceLine" id="cb133-8" title="8">au_temp &lt;-<span class="st"> </span><span class="kw">raster</span>(<span class="st">&quot;data/wc_tavg/wc2.0_2.5m_tavg_01.tif&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb133-9" title="9"><span class="st">  </span><span class="kw">crop</span>(au)</a>
<a class="sourceLine" id="cb133-10" title="10"></a>
<a class="sourceLine" id="cb133-11" title="11"><span class="co"># regular sample of 500k cells</span></a>
<a class="sourceLine" id="cb133-12" title="12"></a>
<a class="sourceLine" id="cb133-13" title="13">sam &lt;-<span class="st"> </span><span class="kw">sampleRegular</span>(au_temp, </a>
<a class="sourceLine" id="cb133-14" title="14">                     <span class="dt">size =</span> <span class="fl">5e5</span>, </a>
<a class="sourceLine" id="cb133-15" title="15">                     <span class="dt">asRaster =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb133-16" title="16"><span class="st">  </span><span class="kw">as.data.frame</span>(<span class="dt">xy =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb133-17" title="17">                <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb133-18" title="18"><span class="st">  </span><span class="kw">setNames</span>(<span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, </a>
<a class="sourceLine" id="cb133-19" title="19">             <span class="st">&quot;y&quot;</span>, </a>
<a class="sourceLine" id="cb133-20" title="20">             <span class="st">&quot;layer&quot;</span>))</a>
<a class="sourceLine" id="cb133-21" title="21"></a>
<a class="sourceLine" id="cb133-22" title="22"><span class="kw">head</span>(sam)</a></code></pre></div>
<pre><code>##            x         y    layer
## 190 122.9583 -10.73417 27.67500
## 191 123.0100 -10.73417 27.57143
## 192 123.0616 -10.73417 27.39091
## 193 123.1133 -10.73417 26.88400
## 194 123.1650 -10.73417 26.35200
## 195 123.2167 -10.73417 26.38800</code></pre>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> sam, </a>
<a class="sourceLine" id="cb135-2" title="2">       <span class="kw">aes</span>(<span class="dt">x =</span> x, </a>
<a class="sourceLine" id="cb135-3" title="3">           <span class="dt">y =</span> y, </a>
<a class="sourceLine" id="cb135-4" title="4">           <span class="dt">fill =</span> layer)) <span class="op">+</span></a>
<a class="sourceLine" id="cb135-5" title="5"><span class="st">  </span><span class="kw">geom_raster</span>()</a></code></pre></div>
<p><img src="EE_Intro_Spatial_Workshop_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
<p>You can change the colour and other parametrs of the plot to make it better. It is important to use <code>coord_sf</code> or <code>coord_fixed</code> to keep the dimention of the plot fixed.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> sam, </a>
<a class="sourceLine" id="cb136-2" title="2">       <span class="kw">aes</span>(<span class="dt">x =</span> x, </a>
<a class="sourceLine" id="cb136-3" title="3">           <span class="dt">y =</span> y, </a>
<a class="sourceLine" id="cb136-4" title="4">           <span class="dt">fill =</span> layer)) <span class="op">+</span></a>
<a class="sourceLine" id="cb136-5" title="5"><span class="st">  </span><span class="kw">geom_raster</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb136-6" title="6"><span class="st">  </span><span class="kw">scale_fill_viridis</span>(<span class="dt">option =</span> <span class="st">&quot;A&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb136-7" title="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Longitude&quot;</span>, </a>
<a class="sourceLine" id="cb136-8" title="8">       <span class="dt">y =</span> <span class="st">&quot;Latitude&quot;</span>, </a>
<a class="sourceLine" id="cb136-9" title="9">       <span class="dt">fill =</span> <span class="st">&quot;Temperature&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb136-10" title="10"><span class="st">  </span><span class="kw">coord_sf</span>(<span class="dt">crs =</span> <span class="dv">4326</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb136-11" title="11"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="EE_Intro_Spatial_Workshop_files/figure-html/unnamed-chunk-56-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="plotting-in-base-r.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true,
"search": true
}
});
});
</script>

</body>

</html>
